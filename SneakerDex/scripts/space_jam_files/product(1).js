var Cookie={create:function(name,value,days){if(days){var date=new Date;date.setTime(date.getTime()+24*days*60*60*1e3);var expires="; expires="+date.toGMTString()}else var expires="";document.cookie=name+"="+value+expires+"; path=/"},read:function(name){for(var nameEQ=name+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(nameEQ))return c.substring(nameEQ.length,c.length)}return null},removeMatchesPairsBySize:function(jpiArray,serialInCartArray){for(var j=0;j<serialInCartArray.length;j++)for(size in jpiArray)for(condition in jpiArray[size])for(pair in jpiArray[size][condition])jpiArray[size][condition].hasOwnProperty(pair)&&jpiArray[size][condition][pair].id==serialInCartArray[j]&&jpiArray[size][condition].splice(pair,1)}};jQuery.fn.outerHTML=function(s){return s?this.before(s).remove():jQuery("<p>").append(this.eq(0).clone()).html()};var Utilities={formatPrice:function(price){return"0000"==price.split(".")[1]?price.split(".")[0]:parseInt(price).toFixed(2)},returnSameCount:function(obj,variable,val){for(var count=0,i=0;i<obj.length;i++)obj[i][variable]==val&&count++;return count},returnSame:function(obj,variable,val){for(var returnArray=[],i=0;i<obj.length;i++)obj[i][variable]==val&&returnArray.push(obj[i]);return returnArray}},Bind={condButtons:function($){$(".button-buy-online").on("click",function(){$("#online-conditional-pairs-container").show(),$(".other-conditions-instore").hide(),$(this).addClass("active"),$(".button-buy-instore").removeClass("active")}),$(".button-buy-instore").on("click",function(){$(".content .other-conditions-instore").show(),$("#online-conditional-pairs-container").hide(),$(this).addClass("active"),$(".button-buy-online").removeClass("active")})},condItems:function($){$(".cond-pair-link").on("click",function(){$("p.instore-item").length?SerialContentUpdates.updateOnNewSize($,$(this).attr("data-index"),'<p class="instore-item"><strong>Following items can be purchased in store</strong></p>'+$(".other-conditions-instore").html()):SerialContentUpdates.updateOnNewSize($,$(this).attr("data-index"),"<p>Sorry, there are no conditional pairs available.</p>")}),$("#online-conditional-pairs-container .sizechart-container").click(function(){$(this).find(".cond-pair-link,.get-pristine").trigger("click")})},pristineLink:function($){$(".get-pristine").on("click",function(e){e.preventDefault(),SerialContentUpdates.updateOnNewSize()})}},jpiModifications={enableDisableSizes:function($){$(".attribute-button-text").each(function(){if($(this).attr("data-optionid"))var sizeId=parseInt($(this).attr("data-optionid"));if("number"==typeof sizeId&&($(this).removeAttr("disabled"),jpiContainer.pairsBySize[sizeId].unconditionalPairs.length<1&&jpiContainer.pairsBySize[sizeId].conditionalPairs.length<1)){$(this).html();$(this).parent().remove()}}),$(".list-size").removeClass("hide"),$(".attribute-option").each(function(){if($(this).attr("data-optionid"))var sizeId=parseInt($(this).attr("data-optionid"));"number"==typeof sizeId&&($(this).removeAttr("disabled"),jpiContainer.pairsBySize[sizeId].unconditionalPairs.length<1&&jpiContainer.pairsBySize[sizeId].conditionalPairs.length<1&&$(this).attr("disabled","disabled"))})},compareInventoryItems:function(){return function(a,b){return a.conditions!=b.conditions?a.conditions>b.conditions?1:-1:a.price-b.price}},structureArrayBySize:function(sizeId,sizeLabel){var pairs={};pairs.conditionalPairs=[],pairs.unconditionalPairs=[],pairs.unserialized={};for(var conditionId in jpiSettings.lookup){var simpleProductElement=jpiSettings.lookup[conditionId][sizeId];if(1==numOfSuperAttributes&&(simpleProductElement=jpiSettings.lookup[sizeId]),"undefined"!=typeof simpleProductElement&&"undefined"!=typeof simpleProductElement.serialized_inventory)if(simpleProductElement.serialized_inventory.toString().length>0){for(var inventoryItemId in simpleProductElement.serialized_inventory)if(jpiContainer.alreadyInCart.indexOf(inventoryItemId)==-1){var inventoryItemEntity=simpleProductElement.serialized_inventory[inventoryItemId];inventoryItemEntity.conditionId=conditionId,inventoryItemEntity.flawless?pairs.unconditionalPairs.push(inventoryItemEntity):pairs.conditionalPairs.push(inventoryItemEntity)}}else pairs.unserialized=simpleProductElement}return pairs.size=sizeLabel,pairs},generatePairsBySize:function($){jpiContainer.pairsBySize={},$(".attribute-button-text").each(function(){var sizeId=parseInt($(this).attr("data-optionid")),sizeLabel=$(this).html().trim();jpiContainer.pairsBySize[sizeId]=jpiModifications.structureArrayBySize(sizeId,sizeLabel)});var serialInCartArray=decodeURIComponent(Cookie.read("serialInCart")).split(",");Cookie.removeMatchesPairsBySize(jpiContainer.pairsBySize,serialInCartArray)},setConditionField:function($,sizeId,el){if(jpiContainer.pairsBySize[sizeId].unconditionalPairs.length)var condition=jpiContainer.pairsBySize[sizeId].unconditionalPairs[0].conditionId;else if(jpiContainer.pairsBySize[sizeId].conditionalPairs.length)var condition=jpiContainer.pairsBySize[sizeId].conditionalPairs[0].conditionId;$("#30_jpi_hidden_attr_179").val(condition)},extendJpiOnclick:function($){if("undefined"!=typeof window.jpiFunctions){var oldFunction=jpiFunctions.optionClick;jpiFunctions.optionClick=function(){var sizeId=$(arguments).data("optionid");"select"==arguments[0].nodeName.toLowerCase()&&(sizeId=arguments[0].value),jpiModifications.setConditionField($,sizeId),jpiContainer.unconditionalPairs=jpiContainer.pairsBySize[sizeId].unconditionalPairs,jpiContainer.conditionalPairs=jpiContainer.pairsBySize[sizeId].conditionalPairs,jpiContainer.unserialized=jpiContainer.pairsBySize[sizeId].unserialized,""==$("#30_jpi_hidden_attr_179").val()&&$(".attribute-button-text").each(function(){var thisSize=jpiContainer.pairsBySize[$(this).attr("data-optionid")];return"undefined"!=typeof thisSize&&thisSize.unconditionalPairs.length?($("#30_jpi_hidden_attr_179").val(thisSize.unconditionalPairs[0].conditionId),$(this).trigger("click"),!1):"undefined"!=typeof thisSize&&thisSize.conditionalPairs.length?($("#30_jpi_hidden_attr_179").val(thisSize.conditionalPairs[0].conditionId),$(this).trigger("click"),!1):void 0}),oldFunction.apply(this,arguments)}}},extendJpiEnableDisableFromLevel:function(){"undefined"!=typeof window.jpiFunctions&&(jpiFunctions.enableDisableFromLevel=function(){return""})},extendJpiLookupFirstBelow:function(){"undefined"!=typeof window.jpiFunctions&&(jpiFunctions.lookupFirstBelow=function(){return""})}},SerialContentUpdates={clear:function($,emptyCondMessage){var condPairs=$(".cond-pairs");condPairs.next(".content").html(emptyCondMessage),$(".add-to-cart .btn-cart").removeAttr("disabled"),$(".product-custom-option").val(""),condPairs.next("div.content").removeClass("open"),condPairs.next("div.content").addClass("hide").removeAttr("style"),condPairs.removeClass("open"),$(".cond-pairs-container").hide(),$(".link-conditional-pairs-container").remove(),$("#product-options-wrapper .notice").remove(),$("#notify-me-link").hide(),$("#notify-me-result, #newsletter-result").hide(),$(".stock-request").remove(),$(".condNotice").remove()},setPickupLoc:function($,loc){var storeLocatorURL=$(".pickup-val").attr("href");$(".pickup").show(),$(".pickup-val").html(loc),"NY"==loc?$(".pickup-val").attr("href",storeLocatorURL+"location/storeview/id/3"):"LA"==loc?$(".pickup-val").attr("href",storeLocatorURL+"location/storeview/id/4"):$(".pickup-val").attr("href",storeLocatorURL)},generateConditionLink:function($,condition,i,locCount){var conDescription="";for(cond in condition.cond_description)conDescription+=$.isEmptyObject(condition.cond_description[cond])?" "+condition.conditions:" "+condition.cond_description[cond].label;return'<a class="cond-pair-link pointer light-blue link-opacity" data-condition-id="'+condition.id+'" data-instoreonly="'+condition.in_store_only+'" data-index="'+i+'">'+conDescription+" "+condition.price+"</a>"},generateConditionsNotice:function($,conditions){var conditionNotices="";if("object"==typeof conditions){for(condition in conditions)conditionNotices+=$.isEmptyObject(conditions[condition])?'<span class="label">'+condition+"</span>":"<strong>"+conditions[condition].label+'</strong><span class="label">'+conditions[condition].description+"</span>";return conditionNotices}},otherConditionsActions:function($,otherConditions,currentIndex){if("undefined"!=typeof otherConditions&&otherConditions.length){for(var existingCondOnline=[],existingCondInstore=[],otherConditionsTextOnline="",otherConditionsTextInstore="",condPairs=$(".cond-pairs"),isMobile=$("#top-bar-under-header-mobile").is(":visible"),priceBox=$(".product-options-bottom.product-options"),shareBtnWrapper=$(".bttn-share-wrapper"),addConditionalAfterElement=isMobile?shareBtnWrapper:priceBox,coditionalBoxTemplate='<div class="accordion sizechart-container" style="display: block;"><div class="drawer border-b"><label class="control __CONTROL_CLASS__"><div class="control__indicator"><span class="check sprite"></span></div></label><span class="sprite condIcon"></span><div class="info-conditions sprite"><div class="info-cond-tooltip">__COND_NOTICE__</div></div><div class="content show-conditional clearfix"><div class="other-conditions-online">__COND_LINK__</div></div></div></div>',i=0;i<otherConditions.length;i++){var condNotice=SerialContentUpdates.generateConditionsNotice($,otherConditions[i].cond_description),boxTemplate=coditionalBoxTemplate.replace("__COND_NOTICE__",condNotice);existingCondOnline.indexOf(otherConditions[i].conditions)<0&&"0"===otherConditions[i].in_store_only?(condSame=Utilities.returnSame(otherConditions,"conditions",otherConditions[i].conditions),locCount=condSame.length,otherConditionsTextOnline+=boxTemplate.replace("__COND_LINK__",this.generateConditionLink($,otherConditions[i],i,locCount)),existingCondOnline.push(otherConditions[i].conditions)):existingCondInstore.indexOf(otherConditions[i].conditions)<0&&"1"===otherConditions[i].in_store_only&&(condSame=Utilities.returnSame(otherConditions,"conditions",otherConditions[i].conditions),locSame=Utilities.returnSame(condSame,"in_store_only",otherConditions[i].in_store_only),locCount=locSame.length,otherConditionsTextInstore+=boxTemplate.replace("__COND_LINK__",this.generateConditionLink($,otherConditions[i],i,locCount)),existingCondInstore.push(otherConditions[i].conditions))}"empty"!=currentIndex&&currentIndex!=-1&&jpiContainer.unconditionalPairs.length?(otherConditionsTextOnline=otherConditionsTextOnline.replace(new RegExp("__CONTROL_CLASS__","g"),"control--checkbox"),addConditionalAfterElement.after('<div class="link-conditional-pairs-container"><a class="link-conditional-pairs get-pristine pointer skip-toggle">SHOP A PRISTINE PAIR INSTEAD</a></div>'),Bind.pristineLink($),$(".cond-pairs-container").show()):"empty"!=currentIndex&&currentIndex!=-1&&otherConditions.length>1?(otherConditionsTextOnline=otherConditionsTextOnline.replace(new RegExp("__CONTROL_CLASS__","g"),"control--radio"),addConditionalAfterElement.after('<div class="link-conditional-pairs-container"><a class="link-conditional-pairs skip-toggle">More Conditional Pairs Available</a></div>'),$(".cond-pairs-container").show()):jpiContainer.unconditionalPairs.length?(otherConditionsTextOnline=otherConditionsTextOnline.replace(new RegExp("__CONTROL_CLASS__","g"),"control--checkbox"),addConditionalAfterElement.after('<div class="link-conditional-pairs-container"><a class="link-conditional-pairs">Conditional Pairs Available</a></div>')):(otherConditionsTextOnline=otherConditionsTextOnline.replace(new RegExp("__CONTROL_CLASS__","g"),"control--radio"),addConditionalAfterElement.after('<div class="link-conditional-pairs-container"><a class="link-conditional-pairs skip-toggle">Conditional Pairs Available</a></div>'),$(".cond-pairs-container").show()),""!==otherConditionsTextOnline&&$("#online-conditional-pairs-container").html(otherConditionsTextOnline),condPairs.next("div.content").removeClass("hide").show(),condPairs.addClass("open");var activeConditionalLink=$('.cond-pair-link[data-index="'+currentIndex+'"]');activeConditionalLink.addClass("selected"),activeConditionalLink.parents(".sizechart-container").addClass("active"),"empty"!=currentIndex&&currentIndex!=-1&&jpiContainer.unconditionalPairs.length&&(activeConditionalLink.removeClass("cond-pair-link").addClass("get-pristine"),Bind.pristineLink($)),"1"==activeConditionalLink.attr("data-instoreonly")?($(".button-buy-instore").addClass("active"),$(".button-buy-online").removeClass("active"),$("#online-conditional-pairs-container").hide(),$(".content .other-conditions-instore").show()):($("button-buy-online").addClass("active"),$(".button-buy-instore").removeClass("active"),$(".content .other-conditions-instore").hide(),$("#online-conditional-pairs-container").show()),Bind.condButtons($),Bind.condItems($),$(".link-conditional-pairs").on("click",function(){$(this).hasClass("skip-toggle")||$(".cond-pairs-container").toggle()})}},updateOnNewSize:function($,index,emptyCondMessage){if("undefined"!=typeof jpiSettings){var $="undefined"!=typeof $?$:jQuery,index="undefined"!=typeof index&&""!=index?index:"empty",emptyCondMessage="undefined"!=typeof $?emptyCondMessage:"";if($(".atca-in-cart").removeClass("atca-in-cart"),$("#atca-checkoutbutton").hide(),"string"==typeof Cookie.read("serialInCart")){var serialInCartArray=decodeURIComponent(Cookie.read("serialInCart")).split(",");Cookie.removeMatchesPairsBySize(jpiContainer.pairsBySize,serialInCartArray)}SerialContentUpdates.clear($,emptyCondMessage);if(jpiSettings.nonSerializedProduct)$(".product-options-bottom .price, .mobile-product-price .price").html(jpiContainer.unserialized.price);else{if(!jpiContainer.unconditionalPairs.length&&!jpiContainer.conditionalPairs.length)return $(".add-to-cart .btn-cart").attr("disabled","disabled"),void jpiModifications.enableDisableSizes($);var attributeId=jpiSettings.attributeIds[0];if("empty"==index)if(jpiContainer.unconditionalPairs.length){var currentArray=jpiContainer.unconditionalPairs,currentSerial=currentArray[0];$('input[name="super_attribute['+attributeId+']"]').val(currentSerial.conditionId)}else{var currentArray=jpiContainer.conditionalPairs,currentSerial=currentArray[0];index=0;SerialContentUpdates.generateConditionsNotice($,currentSerial.cond_description);$('input[name="super_attribute['+attributeId+']"]').val(currentSerial.conditionId)}else if(index==-1)if(jpiContainer.unconditionalPairs.length){var currentArray=jpiContainer.unconditionalPairs,currentSerial=currentArray[0];$('input[name="super_attribute['+attributeId+']"]').val(currentSerial.conditionId)}else{var currentArray=jpiContainer.conditionalPairs,currentSerial=currentArray[0];index=0,$('input[name="super_attribute['+attributeId+']"]').val(currentSerial.conditionId);SerialContentUpdates.generateConditionsNotice($,currentSerial.cond_description)}else if(index>-1){var currentArray=Utilities.returnSame(jpiContainer.conditionalPairs,"conditions",jpiContainer.conditionalPairs[index].conditions),currentSerial=jpiContainer.conditionalPairs[index];SerialContentUpdates.generateConditionsNotice($,currentSerial.cond_description);$('input[name="super_attribute['+attributeId+']"]').val(currentSerial.conditionId)}if(jpiModifications.enableDisableSizes($),"undefined"!=typeof currentSerial&&currentSerial.location.length){var availableMessage="Available in "+currentSerial.location;"J"==currentSerial.location&&(availableMessage="Available online only"),$(".product-options-bottom .location-container").html(availableMessage)}$(".product-options-bottom .price, .mobile-product-price .price").html(currentSerial.price)}if(jpiContainer.conditionalPairs.length)var otherConditions=jpiContainer.conditionalPairs;"undefined"!=typeof currentSerial&&currentSerial.location.length&&SerialContentUpdates.setPickupLoc($,currentSerial.location),"undefined"!=typeof currentSerial&&currentSerial.id.length&&$(".product-custom-option").attr("value",currentSerial.id),SerialContentUpdates.otherConditionsActions($,otherConditions,index)}},sizeButtonClick:function($,el){el.hasClass("js-disabled")?($(".attribute-selected").removeClass("attribute-selected"),$(".product-options-bottom").hide(),jpiContainer.conditionalPairs=[],jpiContainer.unconditionalPairs=[],jpiContainer.unserialized={},SerialContentUpdates.updateOnNewSize($,-1,"Sorry, there are no conditional pairs available"),0==$("#product-options-wrapper .notice").length&&($("#product-options-wrapper").append('<div class="notice mb-margin">Currently out of stock. We\'ll let you know when we refill.</div>'),$("#notify-me-link").show()),$(".add-to-cart .btn-cart").attr("disabled","disabled")):$("p.instore-item").length?($(".location-buttons").append('<button class="button-buy-instore">Buy In Store Only<span class="sprite"></span></button>'),SerialContentUpdates.updateOnNewSize($,-1,"<p><strong>Following items can be purchased in store</strong></p>"+$(".other-conditions-instore").html())):SerialContentUpdates.updateOnNewSize($,-1,"<p>Sorry, there are are no conditional pairs available</p>")}};document.observe("dom:loaded",function(){$("btn-cart-ajax").on("click",function(){currentProduct=this.readAttribute("data-productid"),currentSerialPair=jQuery("serial-id").value,updateBtnCartName(!0),addToCartAjax.add(this,currentProduct,"",SerialContentUpdates.updateOnNewSize,"")||updateBtnCartName(!1)})});var updateBtnCartName=function(isAdding){isAdding?jQuery("#btn-cart-ajax").html("<span>Adding...</span>"):jQuery("#btn-cart-ajax").html("<span>Add to cart</span>")};jQuery(document).ready(function($){var toggleSizeSelectClass=function(){var w=$(window).width(),wrapper=$(".product-sizes-wrapper"),className="vaimo_select";w>767&&wrapper.length>0?wrapper.removeClass(className):wrapper.addClass(className)};if($(window).resize(function(){toggleSizeSelectClass()}),toggleSizeSelectClass(),$(".product-sizes-wrapper.vaimo_select").on("click",function(e){"div"==e.target.nodeName.toLowerCase()&&$(this).find("ul").toggle()}),$("p.instore-item").length&&$(".cond-instore").html('<p class="instore-item"><strong>Following items can be purchased in store</strong></p>'+$(".other-conditions-instore").html()),$(".product-custom-option").length){jpiModifications.generatePairsBySize($),jpiModifications.extendJpiOnclick($),jpiModifications.extendJpiEnableDisableFromLevel($),jpiModifications.extendJpiLookupFirstBelow($),$(".attribute-selected").trigger("click"),$(".attribute-button-text").on("click",function(){SerialContentUpdates.sizeButtonClick($,$(this))});var emptyCondMessage=$(".cond-pairs").next(".content").html();SerialContentUpdates.updateOnNewSize($,"",emptyCondMessage)}var relatedMobileContainer=jQuery(".related-mobile-container");relatedMobileContainer.length>0&&relatedMobileContainer.find(".content .nosto_element").length<1&&relatedMobileContainer.remove()});