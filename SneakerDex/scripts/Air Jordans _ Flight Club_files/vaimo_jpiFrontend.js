function vJpi(){jQuery.fn.vaimoJpiFrontend=function(options,customFunctions,customBinders){var lookupLastPos,lookupLastPos_ix,gallery,thisProductContainer=this,optionElementToLoad=null,settings=jQuery.extend({attributeIds:null,msg_more_options:null,confProductId:null,nonSerializedProduct:null,lookup:null,mainImageSelector:".product-image a img",categoryListMainImageSelector:"",gallerySelector:".more-views ul",galleryImagesSelector:".more-views a img",priceSelector:".product-options-bottom .price",selectedItemInfo:null,qty_sel:0,useConfImages:"No",useForSimples:"No",optionsRenderMethod:"Buttons",isGalleryRendered:!0,enabledDebug:!1,debugMode:"Console",isCategory:!1,categoryAllowClickOnDisabledOptions:!0},options||{}),functions=jQuery.extend({adjustPrice:function(price){jQuery(settings.priceSelector).each(function(){price&&thisProductContainer.find(settings.priceSelector).replaceWith(price)})},adjustPriceHtml:function(price_html){jQuery(settings.priceSelector).each(function(){price_html&&thisProductContainer.find(settings.priceSelector).replaceWith(price_html)})},hasStockBelow:function(lut,ix){if("undefined"!=typeof lut.qty&&"object"!=typeof lut.qty)return lut.qty;if(ix<settings.attributeIds.length)for(var optId in lut)if(lut.hasOwnProperty(optId)){var qtyArray=this.hasStockBelow(lut[optId],ix+1);if(qtyArray)return qtyArray}return!1},lookupFirstBelow:function(lut,key,ix){if("undefined"!=typeof lut[key]&&lut[key])return lut[key];for(var optId in lut){if(ix+1>settings.attributeIds.length)break;if(lut.hasOwnProperty(optId)){var r=this.lookupFirstBelow(lut[optId],key,ix+1);if(r)return r}}return!1},getOptionsStockInfo:function(lut,ix){qtyArray={};for(var optId in lut)lut.hasOwnProperty(optId)&&(qtyArray[optId]=this.hasStockBelow(lut[optId],ix+1));return qtyArray},enableDisableFromLevel:function(lut,ix,productId){lut||(lut=settings.lookup,ix=0);for(var selectedItemInfo;ix<settings.attributeIds.length;){var aid=settings.attributeIds[ix];jQuery("."+productId+"_jpi_attr_"+aid).each(function(){jQuery(this).attr("disabled","disabled")});var firstOpt,option,stockInfo=this.getOptionsStockInfo(lut,ix),optionsArray=[];for(var oid2 in stockInfo)if(stockInfo.hasOwnProperty(oid2)){firstOpt||(firstOpt=oid2),optionsArray[0]=jQuery("#"+productId+"_jpi_option_"+aid+"-"+oid2),optionsArray[1]=jQuery("#"+productId+"_jpi_option_"+aid+"-"+oid2+"_selectOption");for(var i=0;i<optionsArray.length;i++)if(option=optionsArray[i],option&&(stockInfo[oid2]&&option.removeAttr("disabled"),ix==settings.attributeIds.length-1&&option.hasClass("attribute-selected")&&(selectedItemInfo=stockInfo[oid2]>0?lut[oid2]:null),option.hasClass("attribute-selected")&&"undefined"!=typeof selectedItemInfo)){var price,price_html;void 0!==selectedItemInfo.price_html?(price_html=selectedItemInfo.price_html,this.adjustPriceHtml(price_html)):(price=selectedItemInfo.price,this.adjustPrice(price))}}var optionElement=jQuery("#"+productId+"_jpi_hidden_attr_"+settings.attributeIds[ix]),optionValue=optionElement.val();optionValue&&!stockInfo[optionValue]&&(optionElement.val(""),jQuery("#"+productId+"_jpi_option_"+aid+"-"+optionValue).removeClass("attribute-selected")),lut=lut[optionValue?optionValue:firstOpt],ix++}settings.selectedItemInfo=selectedItemInfo},restoreOnLoad:function(){optionElementToLoad&&(optionElementToLoad.onload=this.old_load_f,optionElementToLoad=null,this.old_load_f=null)},checkAddToCart:function(productId){for(var ix=0;ix<settings.attributeIds.length;ix++){var v=jQuery("#"+productId+"_jpi_hidden_attr_"+settings.attributeIds[ix]).val();if(!v)return alert(this.msg_more_options),!1}return!0},replaceMainImage:function(src,dataZoomImage){return thisProductContainer.find(settings.mainImageSelector).fadeTo(500,0),setTimeout(function(){thisProductContainer.find(settings.mainImageSelector).attr("src",src),thisProductContainer.find(settings.mainImageSelector).attr("data-zoom",dataZoomImage),settings.isCategory||thisProductContainer.find(settings.mainImageSelector).parent("a").attr("href",dataZoomImage),thisProductContainer.find(settings.mainImageSelector).fadeTo(500,1)},600),!1},setMainImageFromGallery:function(){gallery.length>0&&(thisProductContainer.find(settings.mainImageSelector).attr("src",gallery[0].main),thisProductContainer.find(settings.mainImageSelector).attr("data-zoom",gallery[0].zoom),settings.isCategory||thisProductContainer.find(settings.mainImageSelector).parent("a").attr("href",gallery[0].zoom))},adjustGallery:function(useConf){var newSetOfImages=!0;if(useConf="No"!=useConf){thisProductContainer.find(settings.gallerySelector).find("li.image-from-simple").remove();var newGallery="";for(var i in gallery)if(this.is_int(i)){var imageMain=gallery[i].main,imageThumb=gallery[i].thumb,imageZoom=gallery[i].zoom;newGallery+='<li class="image-from-simple"><a href="'+imageMain+'"><img src="'+imageThumb+'" data-main="'+imageMain+'" data-zoom="'+imageZoom+'" /></a></li>',imageMain==thisProductContainer.find(settings.mainImageSelector).attr("src")&&(newSetOfImages=!1)}}else{thisProductContainer.find(settings.gallerySelector).empty();var newGallery="";for(var i in gallery)if(is_int(i)){var imageMain=gallery[i].main,imageThumb=gallery[i].thumb,imageZoom=gallery[i].zoom;newGallery+='<li class="image-from-simple"><a href="'+imageMain+'"><img src="'+imageThumb+'" data-main="'+imageMain+'" data-zoom="'+imageZoom+'" /></a></li>',imageMain==thisProductContainer.find(settings.mainImageSelector).attr("src")&&(newSetOfImages=!1)}}thisProductContainer.find(settings.gallerySelector).prepend(newGallery),this.bindGalleryImages(),newSetOfImages&&!useConf?thisProductContainer.find(settings.gallerySelector).find("li:first-child").click():useConf&&thisProductContainer.find(settings.gallerySelector).find("li:first-child").click()},is_int:function(value){return parseFloat(value)==parseInt(value)&&!isNaN(value)},optionClick:function(thisButton,attributeId,optionId,productId){var previouslySelectedOptionId=jQuery("#"+productId+"_jpi_hidden_attr_"+attributeId).val();if(previouslySelectedOptionId!=optionId||"Both"!=settings.optionsRenderMethod){for(var currentLookup=settings.lookup,ix=0;settings.attributeIds[ix]!=attributeId;){var oid=jQuery("#"+productId+"_jpi_hidden_attr_"+settings.attributeIds[ix]).val();""==oid?alert("optionClick - No value - should not happen"):currentLookup=currentLookup[oid],ix++}jQuery("#"+productId+"_jpi_hidden_attr_"+attributeId).val(optionId),previouslySelectedOptionId&&(jQuery(".list-size .js-disabled").removeClass("attribute-selected"),jQuery("#"+productId+"_jpi_option_"+attributeId+"-"+previouslySelectedOptionId).removeClass("attribute-selected")),jQuery(thisButton).addClass("attribute-selected"),this.enableDisableFromLevel(currentLookup,ix,productId),lookupLastPos=currentLookup[optionId],lookupLastPos_ix=ix+1}else jQuery(thisButton).addClass("attribute-selected")}},customFunctions||{}),binders=jQuery.extend({bindOptionButtons:function(){thisProductContainer.find(".attribute-button-text").on("click",function(){if("disabled"!=jQuery(this).attr("disabled")||settings.categoryAllowClickOnDisabledOptions){var productId=jQuery(this).data("productid"),attributeId=jQuery(this).data("attributeid"),optionId=jQuery(this).data("optionid");void 0!=typeof optionId&&null!=optionId&&""!=optionId&&functions.optionClick(this,attributeId,optionId,productId),jQuery(".attribute-select-text.attribute-"+attributeId).val(optionId)}})},bindOptionSelects:function(){thisProductContainer.find(".attribute-select-text").on("change",function(){if("disabled"!=jQuery(this).attr("disabled")){var productId=jQuery(this).data("productid"),attributeId=jQuery(this).data("attributeid"),optionId=jQuery(this).val();void 0!=typeof optionId&&null!=optionId&&""!=optionId&&functions.optionClick(this,attributeId,optionId,productId),jQuery("#"+productId+"_jpi_option_"+attributeId+"-"+optionId).click()}})},bindGalleryImages:function(){thisProductContainer.find(settings.gallerySelector+" li").off("click"),thisProductContainer.find(settings.gallerySelector+" li").on("click",function(){if("disabled"!=jQuery(this).attr("disabled"))return thisProductContainer.find(settings.gallerySelector+" li").removeClass("selected"),jQuery(this).addClass("selected"),functions.replaceMainImage(jQuery(this).children("a").children("img").data("main"),jQuery(this).children("a").children("img").data("zoom")),!1})}},customBinders||{});if(debugMessage=function(message){if(settings.enabledDebug)switch(settings.debugMode){case"Console":console.log(message);break;case"Alert":alert(message);break;case"Both":console.log(message),alert(message)}},0==jQuery(settings.gallerySelector).length&&(settings.isGalleryRendered=!1,debugMessage("Vaimo_JpiFrontend debug : The product gallery seems to be missing. If it is omitted by design ignore this message. Otherwise check your selector!")),0==jQuery(settings.mainImageSelector).length&&debugMessage("Vaimo_JpiFrontend debug : The main product image seems to be missing. If it is omitted by design ignore this message. Otherwise check your selector!"),0==jQuery(settings.priceSelector).length&&debugMessage("Vaimo_JpiFrontend debug : The main product price to be missing. If it is omitted by design ignore this message. Otherwise check your selector!"),settings.isCategory&&(settings.mainImageSelector=settings.categoryListMainImageSelector,0==jQuery(settings.categoryListMainImageSelector).length&&debugMessage("Vaimo_JpiFrontend debug : The main category product image on the category listing seems to be missing. If it is omitted by design ignore this message. Otherwise check your selector!")),window.jpiSettings=settings,window.jpiFunctions=functions,this.each(function(){this.attributeIds=settings.attributeIds,this.msg_more_options=settings.msg_more_options,this.confProductId=settings.confProductId,this.nonSerializedProduct=settings.nonSerializedProduct,this.lookup=settings.lookup,this.mainImageSelector=settings.mainImageSelector,this.categoryListMainImageSelector=settings.categoryListMainImageSelector,this.gallerySelector=settings.gallerySelector,this.galleryImagesSelector=settings.galleryImagesSelector,this.priceSelector=settings.priceSelector,this.selectedItemInfo=settings.selectedItemInfo,this.qty_sel=settings.qty_sel,this.useConfImages=settings.useConfImages,this.useForSimples=settings.useForSimples,this.optionsRenderMethod=settings.optionsRenderMethod,this.isGalleryRendered=settings.isGalleryRendered,this.enabledDebug=settings.enabledDebug,this.debugMode=settings.debugMode,this.isCategory=settings.isCategory,this.categoryAllowClickOnDisabledOptions=settings.categoryAllowClickOnDisabledOptions,this.adjustPrice=functions.adjustPrice,this.adjustPriceHtml=functions.adjustPriceHtml,this.hasStockBelow=functions.hasStockBelow,this.lookupFirstBelow=functions.lookupFirstBelow,this.getOptionsStockInfo=functions.getOptionsStockInfo,this.enableDisableFromLevel=functions.enableDisableFromLevel,this.restoreOnLoad=functions.restoreOnLoad,this.checkAddToCart=functions.checkAddToCart,this.replaceMainImage=functions.replaceMainImage,this.setMainImageFromGallery=functions.setMainImageFromGallery,this.adjustGallery=functions.adjustGallery,this.optionClick=functions.optionClick,this.is_int=functions.is_int}),"No"==settings.useForSimples){switch(this.get(0).enableDisableFromLevel(!1,0,settings.confProductId),settings.optionsRenderMethod){case"Buttons":binders.bindOptionButtons();break;case"Selects":binders.bindOptionSelects();break;case"Both":binders.bindOptionButtons(),binders.bindOptionSelects()}settings.isGalleryRendered&&"undefined"!=typeof functions.bindGalleryImages&&functions.bindGalleryImages(),thisProductContainer.find(".attribute-selected:first-child").click()}else settings.isGalleryRendered&&functions.bindGalleryImages()},jQuery(document).ready(function(){jQueryinitialized=!1;var customFunctionsArray=null,customBindersArray=null;if(jQuery(".product-data-mine").each(function(){var lookupMalformedJSON=jQuery(this).data("lookup"),JSONLookup=lookupMalformedJSON.replace(/'/g,'"'),jpiSettings=jQuery(".jpi-settings"),optionsArray={attributeIds:jQuery(this).data("attributeids"),confProductId:jQuery(this).data("confproductid"),nonSerializedProduct:jQuery(this).data("nonserializedproduct"),messageMoreOptions:jQuery(this).data("messagemoreoptions"),lookup:jQuery.parseJSON(JSONLookup),useConfImages:jpiSettings.data("useimagesfromconfigurable"),optionsRenderMethod:jpiSettings.data("optionsrendermethod"),enabledDebug:jpiSettings.data("enabledebug"),debugMode:jpiSettings.data("debugmode"),mainImageSelector:jpiSettings.data("mainimageselector"),categoryListMainImageSelector:jpiSettings.data("categorylistmainimageselector"),gallerySelector:jpiSettings.data("galleryselector"),galleryImageSelector:jpiSettings.data("galleryimageselector"),priceSelector:jpiSettings.data("priceselector"),isCategory:jpiSettings.data("iscategory")};jpiSettings.data("iscategory")?jQuery(this).parents(".item").vaimoJpiFrontend(optionsArray,customFunctionsArray):jQuery(this).parents(".product-essential").vaimoJpiFrontend(optionsArray,customFunctionsArray),jQueryinitialized=!0}),!jQueryinitialized&&jQuery(".jpi-settings").length>0&&"Yes"==jQuery(".jpi-settings").data("useimageswitcherfunctionalityforallproducttypes")){var optionsArray={useForSimples:jQuery(".jpi-settings").data("useimageswitcherfunctionalityforallproducttypes")};jQuery(".jpi-settings").data("iscategory")?jQuery(this).parents(".item").vaimoJpiFrontend(optionsArray,customFunctionsArray,customBindersArray):jQuery(this).parents(".product-essential").vaimoJpiFrontend(optionsArray,customFunctionsArray,customBindersArray)}}),jQuery(document).on("quickviewUpdate",function(){jQueryinitialized=!1;var customFunctionsArray=null,customBindersArray=null;if(jQuery(".product-data-mine").each(function(){var lookupMalformedJSON=jQuery(this).data("lookup"),JSONLookup=lookupMalformedJSON.replace(/'/g,'"'),jpiSettings=jQuery(".jpi-settings"),optionsArray={attributeIds:jQuery(this).data("attributeids"),confProductId:jQuery(this).data("confproductid"),nonSerializedProduct:jQuery(this).data("nonserializedproduct"),messageMoreOptions:jQuery(this).data("messagemoreoptions"),lookup:jQuery.parseJSON(JSONLookup),useConfImages:jpiSettings.data("useimagesfromconfigurable"),optionsRenderMethod:jpiSettings.data("optionsrendermethod"),enabledDebug:jpiSettings.data("enabledebug"),debugMode:jpiSettings.data("debugmode"),mainImageSelector:jpiSettings.data("mainimageselector"),categoryListMainImageSelector:jpiSettings.data("categorylistmainimageselector"),gallerySelector:jpiSettings.data("galleryselector"),galleryImageSelector:jpiSettings.data("galleryimageselector"),priceSelector:jpiSettings.data("priceselector")};jQuery(this).parents(".product-essential").vaimoJpiFrontend(optionsArray,customFunctionsArray,customBindersArray),jQueryinitialized=!0}),!jQueryinitialized&&jQuery(".jpi-settings").length>0&&"Yes"==jQuery(".jpi-settings").data("useimageswitcherfunctionalityforallproducttypes")){var optionsArray={useForSimples:jQuery(".jpi-settings").data("useimageswitcherfunctionalityforallproducttypes")};jQuery(".product-essential").vaimoJpiFrontend(optionsArray,customFunctionsArray,customBindersArray)}})}vJpi();